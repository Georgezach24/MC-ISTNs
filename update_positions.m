function S = update_positions(S, P, k)
% Συνάρτηση ενημέρωσης θέσεων UE και δορυφόρων σε κάθε time-slot.
% Μοντέλο 1D κίνησης:
% - UE: κινείται γραμμικά και "ανακλάται" στα άκρα της περιοχής (bounce).
% - SAT: απλή προσέγγιση ground-track (οριζόντια προβολή) με κυκλική επαναφορά (wrap/mod).

% --------- Χρονική στιγμή slot ---------------------------------------
t = (k-1) * P.dt;   % Τρέχων χρόνος προσομοίωσης σε seconds (από το index slot k).
%----------------------------------------------------------------------

% =====================================================================
%                         UE - User Equipment
% =====================================================================
% --------- Ενημέρωση θέσης UE ----------------------------------------
S.UE.x = S.UE.x + S.UE.v * P.dt;   % Νέα θέση = παλιά + v*dt (ομοιόμορφη κίνηση).
%----------------------------------------------------------------------

% --------- Bounce στα άκρα της περιοχής ------------------------------
% Αν ο UE βγει εκτός [0, areaLen], τον "επιστρέφουμε" μέσα στην περιοχή
% και αντιστρέφουμε τη φορά (αλλάζει πρόσημο η ταχύτητα).
if S.UE.x < 0
    S.UE.x = -S.UE.x;     % Αντανάκλαση στη θέση 0.
    S.UE.v = -S.UE.v;     % Αντιστροφή ταχύτητας.
elseif S.UE.x > P.areaLen
    S.UE.x = 2*P.areaLen - S.UE.x; % Αντανάκλαση στη θέση areaLen.
    S.UE.v = -S.UE.v;               % Αντιστροφή ταχύτητας.
end
%----------------------------------------------------------------------

% =====================================================================
%                           Satellites (NTN)
% =====================================================================
% --------- Ground-track proxy motion (wrap) ---------------------------
% Μοντελοποιούμε την οριζόντια θέση του δορυφόρου ως:
% x(t) = x0 + v*t, και εφαρμόζουμε mod(areaLen) για κυκλική επαναφορά.
% Δηλαδή όταν "φτάσει" στο τέλος της περιοχής, ξαναμπαίνει από την αρχή.
for i = 1:numel(P.SAT)
    S.SATx(i) = mod(P.SAT(i).x0 + P.SAT(i).v * t, P.areaLen);
end
%----------------------------------------------------------------------

end